Loading rhel8/default-amp
  Loading requirement: dot rhel8/slurm singularity/current rhel8/global
    cuda/11.4 libpciaccess/0.16/gcc-9.4.0-6fonbj6
    libiconv/1.16/gcc-9.4.0-ahebbov libxml2/2.9.12/gcc-9.4.0-gnknt5e
    ncurses/6.2/gcc-9.4.0-aiirok7 hwloc/2.5.0/gcc-9.4.0-7sqomga
    libevent/2.1.12/gcc-9.4.0-hgny7cm numactl/2.0.14/gcc-9.4.0-52dwc6n
    cuda/11.4.0/gcc-9.4.0-3hnxhjt gdrcopy/2.2/gcc-9.4.0-e4igtfp
    knem/1.1.4/gcc-9.4.0-bpbxgva libnl/3.3.0/gcc-9.4.0-whwhrwb
    rdma-core/34.0/gcc-9.4.0-5eo5n2u ucx/1.11.1/gcc-9.4.0-lktqyl4
    openmpi/4.1.1/gcc-9.4.0-epagguv
Changed directory to /home/er647/projects/feature-wise-active-learning.

JobID: 43081730
======
Time: Sat Jan 27 13:05:54 GMT 2024
Running on master node: gpu-q-22
Current directory: /home/er647/projects/feature-wise-active-learning

Nodes allocated:
================
gpu-q-22

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
wandb agent evangeorgerex/fwal/hy72bous

wandb: Starting wandb agent 🕵️
2024-01-27 13:06:05,020 - wandb.wandb_agent - INFO - Running runs: []
2024-01-27 13:06:05,288 - wandb.wandb_agent - INFO - Agent received command: run
2024-01-27 13:06:05,288 - wandb.wandb_agent - INFO - Agent starting run with config:
	dataset: summed_squares_exponential_synth
	mask_init_value: -1
	mask_type: gumbel_softmax
	repeat_id: 0
	seed_model_init: 1
2024-01-27 13:06:05,295 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /home/er647/projects/feature-wise-active-learning/src/run_experiment.py --model fwal --valid_percentage 0.25 --sparsity_type global --gamma 1 --sparsity_regularizer L1 --sparsity_regularizer_hyperparam 1 --test_time_interventions evaluate_test_time_interventions --hpc_run --num_workers 31 --tags c50d3bf6 --notes "Comparing different constant mask initialisations. Gumbel and Softmax. All 5 datasets. x3 test splits x3 weight inits" --dataset=summed_squares_exponential_synth --mask_init_value=-1 --mask_type=gumbel_softmax --repeat_id=0 --seed_model_init=1
2024-01-27 13:06:10,308 - wandb.wandb_agent - INFO - Running runs: ['at6dgxoe']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: evangeorgerex. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in ./wandb/run-20240127_130624-at6dgxoe
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run wild-sweep-29
wandb: ⭐️ View project at https://wandb.ai/evangeorgerex/fwal
wandb: 🧹 View sweep at https://wandb.ai/evangeorgerex/fwal/sweeps/hy72bous
wandb: 🚀 View run at https://wandb.ai/evangeorgerex/fwal/runs/at6dgxoe
wandb: WARNING Config item 'dataset' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_type' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'repeat_id' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'seed_model_init' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_init_value' was locked by 'sweep' (ignored update).
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 1
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Starting...

Inside training function

Loading data summed_squares_exponential_synth...
Train size: 6000

Valid size: 2000

Test size: 2000

Weights for the classification loss: [1.4170997 0.7725985]
Train/Valid/Test splits of sizes 6000, 2000, 2000
Num of features: 11
Training for max_epochs = 14
┏━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name                  ┃ Type       ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ reconstruction_module │ Sequential │  8.8 K │
│ 1 │ prediction_module     │ Sequential │  8.4 K │
│   │ other params          │ n/a        │     11 │
└───┴───────────────────────┴────────────┴────────┘
Trainable params: 17.2 K                                                        
Non-trainable params: 0                                                         
Total params: 17.2 K                                                            
Total estimated model params size (MB): 0                                       
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
Epoch 0, global step 5: 'valid/cross_entropy_loss' reached 0.69385 (best 0.69385), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=5.ckpt' as top 1
Epoch 0, global step 10: 'valid/cross_entropy_loss' reached 0.69324 (best 0.69324), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=10.ckpt' as top 1
Epoch 0, global step 15: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 20: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 25: 'valid/cross_entropy_loss' reached 0.69320 (best 0.69320), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=25.ckpt' as top 1
Epoch 0, global step 30: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 35: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 40: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 45: 'valid/cross_entropy_loss' reached 0.69295 (best 0.69295), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=45.ckpt' as top 1
Epoch 0, global step 50: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 55: 'valid/cross_entropy_loss' reached 0.69227 (best 0.69227), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=55.ckpt' as top 1
Epoch 0, global step 60: 'valid/cross_entropy_loss' reached 0.69142 (best 0.69142), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=60.ckpt' as top 1
Epoch 0, global step 65: 'valid/cross_entropy_loss' reached 0.68744 (best 0.68744), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=65.ckpt' as top 1
Epoch 0, global step 70: 'valid/cross_entropy_loss' reached 0.68582 (best 0.68582), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=70.ckpt' as top 1
Epoch 0, global step 75: 'valid/cross_entropy_loss' reached 0.68034 (best 0.68034), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=75.ckpt' as top 1
Epoch 0, global step 80: 'valid/cross_entropy_loss' reached 0.67240 (best 0.67240), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=80.ckpt' as top 1
Epoch 0, global step 85: 'valid/cross_entropy_loss' reached 0.66816 (best 0.66816), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=85.ckpt' as top 1
Epoch 0, global step 90: 'valid/cross_entropy_loss' reached 0.66289 (best 0.66289), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=90.ckpt' as top 1
Epoch 0, global step 95: 'valid/cross_entropy_loss' reached 0.62974 (best 0.62974), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=95.ckpt' as top 1
Epoch 0, global step 100: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 105: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 110: 'valid/cross_entropy_loss' reached 0.62319 (best 0.62319), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=110.ckpt' as top 1
Epoch 0, global step 115: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 120: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 125: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 130: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 135: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 140: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 145: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 150: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 155: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 160: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 165: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 170: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 175: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 180: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 185: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 190: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 195: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 200: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 205: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 210: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 215: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 220: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 225: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 230: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 235: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 240: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 245: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 250: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 255: 'valid/cross_entropy_loss' reached 0.61019 (best 0.61019), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=255.ckpt' as top 1
Epoch 0, global step 260: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 265: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 270: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 275: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 280: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 285: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 290: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 295: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 300: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 305: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 310: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 315: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 320: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 325: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 330: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 335: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 340: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 345: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 350: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 355: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 360: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 365: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 370: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 375: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 380: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 385: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 390: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 395: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 400: 'valid/cross_entropy_loss' reached 0.60606 (best 0.60606), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=400.ckpt' as top 1
Epoch 0, global step 405: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 410: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 415: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 420: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 425: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 430: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 435: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 440: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 445: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 450: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 455: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 460: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 465: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 470: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 475: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 480: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 485: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 490: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 495: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 500: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 505: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 510: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 515: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 520: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 525: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 530: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 535: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 540: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 545: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 550: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 555: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 560: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 565: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 570: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 575: 'valid/cross_entropy_loss' reached 0.58849 (best 0.58849), saving model to './fwal/at6dgxoe/checkpoints/epoch=0-step=575.ckpt' as top 1
Epoch 0, global step 580: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 585: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 590: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 595: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 600: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 605: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 610: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 615: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 620: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 625: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 630: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 635: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 640: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 645: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 650: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 655: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 660: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 665: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 670: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 675: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 680: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 685: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 690: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 695: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 700: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 705: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 710: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 715: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 720: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 725: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 730: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 735: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 740: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 745: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 750: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 755: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 760: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 765: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 770: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 775: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 780: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 785: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 790: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 795: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 800: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 805: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 810: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 815: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 820: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 825: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 830: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 835: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 840: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 845: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 850: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 855: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 860: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 865: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 870: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 875: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 880: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 885: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 890: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 895: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 900: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 905: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 910: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 915: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 920: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 925: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 930: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 935: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 940: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 945: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 950: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 955: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 960: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 965: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 970: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 975: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 980: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 985: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 990: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 995: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1000: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1005: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1010: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1015: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1020: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1025: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1030: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1035: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1040: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1045: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1050: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1055: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1060: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1065: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1070: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1075: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1080: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1085: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1090: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1095: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1100: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1105: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1110: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1115: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1120: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1125: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1130: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1135: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1140: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1145: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1150: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1155: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1160: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1165: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1170: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1175: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1180: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1185: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1190: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1195: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1200: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1205: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1210: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1215: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1220: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1225: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1230: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1235: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1240: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1245: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1250: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1255: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1260: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1265: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1270: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1275: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1280: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1285: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1290: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1295: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1300: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1305: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1310: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1315: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1320: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1325: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1330: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1335: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1340: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1345: 'valid/cross_entropy_loss' reached 0.58404 (best 0.58404), saving model to './fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt' as top 1
Epoch 1, global step 1350: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1355: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1360: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1365: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1370: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1375: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1380: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1385: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1390: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1395: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1400: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1405: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1410: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1415: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1420: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1425: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1430: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1435: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1440: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1445: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1450: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1455: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1460: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1465: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1470: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1475: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1480: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1485: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1490: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1495: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1500: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1505: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1510: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1515: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1520: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1525: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1530: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1535: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1540: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1545: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1550: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1555: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1560: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1565: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1570: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1575: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1580: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1585: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1590: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1595: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1600: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1605: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1610: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1615: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1620: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1625: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1630: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1635: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1640: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1645: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1650: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1655: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1660: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1665: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1670: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1675: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1680: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1685: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1690: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1695: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1700: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1705: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1710: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1715: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1720: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1725: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1730: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1735: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1740: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1745: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1750: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1755: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1760: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1765: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1770: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1775: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1780: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1785: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1790: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1795: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1800: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1805: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1810: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1815: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1820: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1825: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1830: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1835: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1840: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1845: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1850: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1855: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1860: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1865: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1870: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1875: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1880: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1885: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1890: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1895: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1900: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1905: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1910: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1915: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1920: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1925: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1930: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1935: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1940: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1945: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1950: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1955: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1960: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1965: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1970: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1975: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1980: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1985: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1990: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1995: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2000: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2005: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2010: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2015: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2020: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2025: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2030: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2035: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2040: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2045: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2050: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2055: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2060: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2065: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2070: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2075: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2080: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2085: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2090: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2095: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2100: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2105: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2110: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2115: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2120: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2125: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2130: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2135: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2140: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2145: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2150: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2155: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2160: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2165: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2170: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2175: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2180: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2185: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2190: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2195: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2200: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2205: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2210: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2215: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2220: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2225: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2230: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2235: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2240: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2245: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2250: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2255: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2260: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2265: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2270: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2275: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2280: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2285: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2290: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2295: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2300: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2305: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2310: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2315: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2320: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2325: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2330: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2335: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2340: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2345: 'valid/cross_entropy_loss' was not in top 1
Epoch 3/-2 ━━╸                    95/750 0:00:08 • 0:00:56 11.85it/s v_num: gxoe
Restoring states from the checkpoint path at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/er647/anaconda3/envs/fwal/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:492: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.


Best model saved on path ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_train/AUROC_weighted    │         0.6069519145930123          │
│     bestmodel_train/F1_weighted     │         0.6187778432552518          │
│  bestmodel_train/balanced_accuracy  │         0.6069519145930123          │
│ bestmodel_train/cross_entropy_loss  │          0.620398759841919          │
│ bestmodel_train/precision_weighted  │         0.6391991439983561          │
│   bestmodel_train/recall_weighted   │         0.6108333333333333          │
│ bestmodel_train/reconstruction_loss │          0.607421338558197          │
│    bestmodel_train/sparsity_loss    │         1.4773333072662354          │
│     bestmodel_train/total_loss      │          2.705153465270996          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 750/750 0:00:01 • 0:00:00 474.98it/s 
Restoring states from the checkpoint path at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_valid/AUROC_weighted    │         0.6134090873479122          │
│     bestmodel_valid/F1_weighted     │         0.6243492563457491          │
│  bestmodel_valid/balanced_accuracy  │         0.6134090873479122          │
│ bestmodel_valid/cross_entropy_loss  │         0.6200994253158569          │
│ bestmodel_valid/precision_weighted  │         0.6449896609826703          │
│   bestmodel_valid/recall_weighted   │               0.6165                │
│ bestmodel_valid/reconstruction_loss │         0.6062018871307373          │
│    bestmodel_valid/sparsity_loss    │         1.4712793827056885          │
│     bestmodel_valid/total_loss      │          2.697580575942993          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 572.85it/s 
Restoring states from the checkpoint path at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/at6dgxoe/checkpoints/epoch=1-step=1345.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃            Test metric             ┃            DataLoader 0            ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_test/AUROC_weighted    │         0.6110252712539487         │
│     bestmodel_test/F1_weighted     │         0.6192831542623184         │
│  bestmodel_test/balanced_accuracy  │         0.6110252712539487         │
│ bestmodel_test/cross_entropy_loss  │         0.620256781578064          │
│ bestmodel_test/precision_weighted  │         0.643216427080175          │
│   bestmodel_test/recall_weighted   │               0.611                │
│ bestmodel_test/reconstruction_loss │         0.6085129380226135         │
│    bestmodel_test/sparsity_loss    │          1.47826087474823          │
│     bestmodel_test/total_loss      │         2.7070305347442627         │
└────────────────────────────────────┴────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 557.70it/s 
wandb: - 1.530 MB of 1.932 MB uploadedwandb: \ 1.530 MB of 1.932 MB uploadedwandb: | 1.932 MB of 1.932 MB uploadedwandb: / 1.932 MB of 1.932 MB uploadedwandb: - 1.988 MB of 1.988 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       bestmodel_test/AUROC_weighted ▁
wandb:          bestmodel_test/F1_weighted ▁
wandb:    bestmodel_test/balanced_accuracy ▁
wandb:   bestmodel_test/cross_entropy_loss ▁
wandb:   bestmodel_test/precision_weighted ▁
wandb:      bestmodel_test/recall_weighted ▁
wandb:  bestmodel_test/reconstruction_loss ▁
wandb:        bestmodel_test/sparsity_loss ▁
wandb:           bestmodel_test/total_loss ▁
wandb:      bestmodel_train/AUROC_weighted ▁
wandb:         bestmodel_train/F1_weighted ▁
wandb:   bestmodel_train/balanced_accuracy ▁
wandb:  bestmodel_train/cross_entropy_loss ▁
wandb:  bestmodel_train/precision_weighted ▁
wandb:     bestmodel_train/recall_weighted ▁
wandb: bestmodel_train/reconstruction_loss ▁
wandb:       bestmodel_train/sparsity_loss ▁
wandb:          bestmodel_train/total_loss ▁
wandb:      bestmodel_valid/AUROC_weighted ▁
wandb:         bestmodel_valid/F1_weighted ▁
wandb:   bestmodel_valid/balanced_accuracy ▁
wandb:  bestmodel_valid/cross_entropy_loss ▁
wandb:  bestmodel_valid/precision_weighted ▁
wandb:     bestmodel_valid/recall_weighted ▁
wandb: bestmodel_valid/reconstruction_loss ▁
wandb:       bestmodel_valid/sparsity_loss ▁
wandb:          bestmodel_valid/total_loss ▁
wandb:                               epoch ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▆▆▆▆▆▆▆▆▆▆▆▆██
wandb:                        lr_scheduler ██▇▇▆▆▆▆▅▅▅▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:                            num_nans ▁▁▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆█
wandb:                train/AUROC_weighted ▁██▃
wandb:                   train/F1_weighted ▁█▆▇
wandb:             train/balanced_accuracy ▁██▃
wandb:            train/cross_entropy_loss ▇▆▆▄▆▄▆▆▇▆▆▇▁▆█▆▆▄▄▅▇▄▅▂▅▄▆▆▆▇▃▅▆▇▆▄▆▃▆▇
wandb:            train/precision_weighted ▅▇█▁
wandb:               train/recall_weighted ▁█▆▇
wandb:           train/reconstruction_loss ▂▃▂▁▁▁▁▂▃▁▁▂▁▁▁▃█▁▁▁▂▂▂▁▁▁▂▁▂▁▁▁▂▁▁▁▁▁▁▂
wandb:                 train/sparsity_loss ▅▁▁▃▁▅▃▁▁▅█▅▅▅█▃▁▃█▃▃▃▅▅▆▃▁▃▃▅▆▆▃█▁▆▅▅▁▁
wandb:                    train/total_loss ▄▂▁▂▁▄▂▁▃▄▇▅▃▄▇▄█▂▆▂▃▃▄▃▅▂▂▂▃▄▅▅▃▇▁▅▄▄▁▁
wandb:                 trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▆▆▆▆▇▇▇██████████████
wandb:                valid/AUROC_weighted ▁▁▄▅▅▅▆▅▅▅▅▇▇▄▄▆▄▆▇▆▆▆█▅▇▅▇▇█▇▇█▇▄▆▇▆▅▆█
wandb:                   valid/F1_weighted ▄▄▃▄▁▁▂▇▇▇█▇█▇▇▇▇▇▅▄▄▄▆▇▇▁▄▄▆▆▇▆█▇▇▅▇▇█▅
wandb:             valid/balanced_accuracy ▁▁▄▅▅▅▆▅▅▅▅▇▇▄▄▆▄▆▇▆▆▆█▅▇▅▇▇█▇▇█▇▄▆▇▆▅▆█
wandb:            valid/cross_entropy_loss ▄▄█▄▂▃▂▂▂▃▂▂▂▃▃▂▂▂▁▂▂▂▁▂▁▂▂▂▂▁▁▁▁▂▂▁▂▂▂▁
wandb:            valid/precision_weighted ▁▁▆▆▇▇█▅▅▅▆▆▆▅▅▆▅▆█▇▇██▅▆████▇▆█▆▅▆█▆▅▆█
wandb:               valid/recall_weighted ██▂▃▁▁▂▆▇▇█▇▇▇█▆▇▇▅▃▃▃▆▆▆▁▃▄▅▅▆▅█▇▆▄▇▇▇▅
wandb:           valid/reconstruction_loss █▆▅▅▄▅▅▄▅▄▅▂▂▅▆▃▅▃▃▄▄▃▁▄▃▅▃▃▃▂▃▂▃▄▄▂▃▃▃▂
wandb:                 valid/sparsity_loss ▂▃▄▇▁▄▄▅▂▃▁█▆▃▁▅▃▅▆▅▄▅█▂▇▂▆▅▅▆▆▆▃▄▅▆▅▄▆▆
wandb:                    valid/total_loss ▄▄▆█▁▄▄▅▂▃▁▇▆▃▂▄▃▄▅▄▃▄▇▂▇▂▆▄▅▅▅▅▂▄▅▅▄▄▅▅
wandb: 
wandb: Run summary:
wandb:                      bestmodel/step 1345
wandb:       bestmodel_test/AUROC_weighted 0.61103
wandb:          bestmodel_test/F1_weighted 0.61928
wandb:    bestmodel_test/balanced_accuracy 0.61103
wandb:   bestmodel_test/cross_entropy_loss 0.62026
wandb:   bestmodel_test/precision_weighted 0.64322
wandb:      bestmodel_test/recall_weighted 0.611
wandb:  bestmodel_test/reconstruction_loss 0.60851
wandb:        bestmodel_test/sparsity_loss 1.47826
wandb:           bestmodel_test/total_loss 2.70703
wandb:      bestmodel_train/AUROC_weighted 0.60695
wandb:         bestmodel_train/F1_weighted 0.61878
wandb:   bestmodel_train/balanced_accuracy 0.60695
wandb:  bestmodel_train/cross_entropy_loss 0.6204
wandb:  bestmodel_train/precision_weighted 0.6392
wandb:     bestmodel_train/recall_weighted 0.61083
wandb: bestmodel_train/reconstruction_loss 0.60742
wandb:       bestmodel_train/sparsity_loss 1.47733
wandb:          bestmodel_train/total_loss 2.70515
wandb:      bestmodel_valid/AUROC_weighted 0.61341
wandb:         bestmodel_valid/F1_weighted 0.62435
wandb:   bestmodel_valid/balanced_accuracy 0.61341
wandb:  bestmodel_valid/cross_entropy_loss 0.6201
wandb:  bestmodel_valid/precision_weighted 0.64499
wandb:     bestmodel_valid/recall_weighted 0.6165
wandb: bestmodel_valid/reconstruction_loss 0.6062
wandb:       bestmodel_valid/sparsity_loss 1.47128
wandb:          bestmodel_valid/total_loss 2.69758
wandb:                               epoch 4
wandb:                        lr_scheduler 0.00029
wandb:                            num_nans 11
wandb:                train/AUROC_weighted 0.59559
wandb:                   train/F1_weighted 0.58293
wandb:             train/balanced_accuracy 0.59559
wandb:            train/cross_entropy_loss 0.58685
wandb:            train/precision_weighted 0.62295
wandb:               train/recall_weighted 0.57763
wandb:           train/reconstruction_loss 0.26227
wandb:                 train/sparsity_loss 2.0
wandb:                    train/total_loss 2.84911
wandb:                 trainer/global_step 2345
wandb:                valid/AUROC_weighted 0.6621
wandb:                   valid/F1_weighted 0.57725
wandb:             valid/balanced_accuracy 0.6621
wandb:            valid/cross_entropy_loss 0.59591
wandb:            valid/precision_weighted 0.74497
wandb:               valid/recall_weighted 0.5865
wandb:           valid/reconstruction_loss 0.49211
wandb:                 valid/sparsity_loss 1.875
wandb:                    valid/total_loss 2.96303
wandb: 
wandb: 🚀 View run wild-sweep-29 at: https://wandb.ai/evangeorgerex/fwal/runs/at6dgxoe
wandb: Synced 3 W&B file(s), 3 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240127_130624-at6dgxoe/logs

Exiting from train function..
2024-01-27 13:10:48,365 - wandb.wandb_agent - INFO - Cleaning up finished run: at6dgxoe
2024-01-27 13:10:48,917 - wandb.wandb_agent - INFO - Agent received command: run
2024-01-27 13:10:48,917 - wandb.wandb_agent - INFO - Agent starting run with config:
	dataset: summed_squares_exponential_synth
	mask_init_value: -1
	mask_type: gumbel_softmax
	repeat_id: 0
	seed_model_init: 2
2024-01-27 13:10:48,923 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /home/er647/projects/feature-wise-active-learning/src/run_experiment.py --model fwal --valid_percentage 0.25 --sparsity_type global --gamma 1 --sparsity_regularizer L1 --sparsity_regularizer_hyperparam 1 --test_time_interventions evaluate_test_time_interventions --hpc_run --num_workers 31 --tags c50d3bf6 --notes "Comparing different constant mask initialisations. Gumbel and Softmax. All 5 datasets. x3 test splits x3 weight inits" --dataset=summed_squares_exponential_synth --mask_init_value=-1 --mask_type=gumbel_softmax --repeat_id=0 --seed_model_init=2
2024-01-27 13:10:53,932 - wandb.wandb_agent - INFO - Running runs: ['n779aoli']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: evangeorgerex. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in ./wandb/run-20240127_131056-n779aoli
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run distinctive-sweep-30
wandb: ⭐️ View project at https://wandb.ai/evangeorgerex/fwal
wandb: 🧹 View sweep at https://wandb.ai/evangeorgerex/fwal/sweeps/hy72bous
wandb: 🚀 View run at https://wandb.ai/evangeorgerex/fwal/runs/n779aoli
wandb: WARNING Config item 'dataset' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_type' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'repeat_id' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'seed_model_init' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_init_value' was locked by 'sweep' (ignored update).
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 2
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Starting...

Inside training function

Loading data summed_squares_exponential_synth...
Train size: 6000

Valid size: 2000

Test size: 2000

Weights for the classification loss: [1.4170997 0.7725985]
Train/Valid/Test splits of sizes 6000, 2000, 2000
Num of features: 11
Training for max_epochs = 14
┏━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name                  ┃ Type       ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ reconstruction_module │ Sequential │  8.8 K │
│ 1 │ prediction_module     │ Sequential │  8.4 K │
│   │ other params          │ n/a        │     11 │
└───┴───────────────────────┴────────────┴────────┘
Trainable params: 17.2 K                                                        
Non-trainable params: 0                                                         
Total params: 17.2 K                                                            
Total estimated model params size (MB): 0                                       
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
Epoch 0, global step 5: 'valid/cross_entropy_loss' reached 0.69361 (best 0.69361), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=5.ckpt' as top 1
Epoch 0, global step 10: 'valid/cross_entropy_loss' reached 0.69353 (best 0.69353), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=10.ckpt' as top 1
Epoch 0, global step 15: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 20: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 25: 'valid/cross_entropy_loss' reached 0.69325 (best 0.69325), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=25.ckpt' as top 1
Epoch 0, global step 30: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 35: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 40: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 45: 'valid/cross_entropy_loss' reached 0.69319 (best 0.69319), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=45.ckpt' as top 1
Epoch 0, global step 50: 'valid/cross_entropy_loss' reached 0.69297 (best 0.69297), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=50.ckpt' as top 1
Epoch 0, global step 55: 'valid/cross_entropy_loss' reached 0.69174 (best 0.69174), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=55.ckpt' as top 1
Epoch 0, global step 60: 'valid/cross_entropy_loss' reached 0.68982 (best 0.68982), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=60.ckpt' as top 1
Epoch 0, global step 65: 'valid/cross_entropy_loss' reached 0.68268 (best 0.68268), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=65.ckpt' as top 1
Epoch 0, global step 70: 'valid/cross_entropy_loss' reached 0.67438 (best 0.67438), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=70.ckpt' as top 1
Epoch 0, global step 75: 'valid/cross_entropy_loss' reached 0.66573 (best 0.66573), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=75.ckpt' as top 1
Epoch 0, global step 80: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 85: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 90: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 95: 'valid/cross_entropy_loss' reached 0.64654 (best 0.64654), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=95.ckpt' as top 1
Epoch 0, global step 100: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 105: 'valid/cross_entropy_loss' reached 0.64434 (best 0.64434), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=105.ckpt' as top 1
Epoch 0, global step 110: 'valid/cross_entropy_loss' reached 0.63563 (best 0.63563), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=110.ckpt' as top 1
Epoch 0, global step 115: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 120: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 125: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 130: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 135: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 140: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 145: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 150: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 155: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 160: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 165: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 170: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 175: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 180: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 185: 'valid/cross_entropy_loss' reached 0.62916 (best 0.62916), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=185.ckpt' as top 1
Epoch 0, global step 190: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 195: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 200: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 205: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 210: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 215: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 220: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 225: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 230: 'valid/cross_entropy_loss' reached 0.62797 (best 0.62797), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=230.ckpt' as top 1
Epoch 0, global step 235: 'valid/cross_entropy_loss' reached 0.62456 (best 0.62456), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=235.ckpt' as top 1
Epoch 0, global step 240: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 245: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 250: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 255: 'valid/cross_entropy_loss' reached 0.61092 (best 0.61092), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=255.ckpt' as top 1
Epoch 0, global step 260: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 265: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 270: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 275: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 280: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 285: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 290: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 295: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 300: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 305: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 310: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 315: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 320: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 325: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 330: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 335: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 340: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 345: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 350: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 355: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 360: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 365: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 370: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 375: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 380: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 385: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 390: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 395: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 400: 'valid/cross_entropy_loss' reached 0.60391 (best 0.60391), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=400.ckpt' as top 1
Epoch 0, global step 405: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 410: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 415: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 420: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 425: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 430: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 435: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 440: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 445: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 450: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 455: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 460: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 465: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 470: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 475: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 480: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 485: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 490: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 495: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 500: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 505: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 510: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 515: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 520: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 525: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 530: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 535: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 540: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 545: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 550: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 555: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 560: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 565: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 570: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 575: 'valid/cross_entropy_loss' reached 0.59815 (best 0.59815), saving model to './fwal/n779aoli/checkpoints/epoch=0-step=575.ckpt' as top 1
Epoch 0, global step 580: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 585: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 590: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 595: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 600: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 605: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 610: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 615: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 620: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 625: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 630: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 635: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 640: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 645: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 650: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 655: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 660: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 665: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 670: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 675: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 680: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 685: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 690: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 695: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 700: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 705: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 710: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 715: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 720: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 725: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 730: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 735: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 740: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 745: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 750: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 755: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 760: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 765: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 770: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 775: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 780: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 785: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 790: 'valid/cross_entropy_loss' reached 0.59769 (best 0.59769), saving model to './fwal/n779aoli/checkpoints/epoch=1-step=790.ckpt' as top 1
Epoch 1, global step 795: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 800: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 805: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 810: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 815: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 820: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 825: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 830: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 835: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 840: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 845: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 850: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 855: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 860: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 865: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 870: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 875: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 880: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 885: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 890: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 895: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 900: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 905: 'valid/cross_entropy_loss' reached 0.59137 (best 0.59137), saving model to './fwal/n779aoli/checkpoints/epoch=1-step=905.ckpt' as top 1
Epoch 1, global step 910: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 915: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 920: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 925: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 930: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 935: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 940: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 945: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 950: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 955: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 960: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 965: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 970: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 975: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 980: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 985: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 990: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 995: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1000: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1005: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1010: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1015: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1020: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1025: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1030: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1035: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1040: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1045: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1050: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1055: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1060: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1065: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1070: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1075: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1080: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1085: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1090: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1095: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1100: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1105: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1110: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1115: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1120: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1125: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1130: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1135: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1140: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1145: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1150: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1155: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1160: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1165: 'valid/cross_entropy_loss' reached 0.58868 (best 0.58868), saving model to './fwal/n779aoli/checkpoints/epoch=1-step=1165.ckpt' as top 1
Epoch 1, global step 1170: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1175: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1180: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1185: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1190: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1195: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1200: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1205: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1210: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1215: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1220: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1225: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1230: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1235: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1240: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1245: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1250: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1255: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1260: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1265: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1270: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1275: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1280: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1285: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1290: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1295: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1300: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1305: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1310: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1315: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1320: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1325: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1330: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1335: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1340: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1345: 'valid/cross_entropy_loss' reached 0.58211 (best 0.58211), saving model to './fwal/n779aoli/checkpoints/epoch=1-step=1345.ckpt' as top 1
Epoch 1, global step 1350: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1355: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1360: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1365: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1370: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1375: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1380: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1385: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1390: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1395: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1400: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1405: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1410: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1415: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1420: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1425: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1430: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1435: 'valid/cross_entropy_loss' reached 0.58145 (best 0.58145), saving model to './fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt' as top 1
Epoch 1, global step 1440: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1445: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1450: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1455: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1460: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1465: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1470: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1475: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1480: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1485: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1490: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1495: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1500: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1505: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1510: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1515: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1520: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1525: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1530: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1535: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1540: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1545: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1550: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1555: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1560: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1565: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1570: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1575: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1580: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1585: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1590: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1595: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1600: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1605: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1610: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1615: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1620: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1625: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1630: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1635: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1640: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1645: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1650: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1655: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1660: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1665: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1670: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1675: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1680: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1685: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1690: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1695: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1700: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1705: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1710: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1715: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1720: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1725: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1730: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1735: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1740: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1745: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1750: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1755: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1760: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1765: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1770: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1775: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1780: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1785: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1790: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1795: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1800: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1805: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1810: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1815: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1820: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1825: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1830: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1835: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1840: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1845: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1850: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1855: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1860: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1865: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1870: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1875: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1880: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1885: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1890: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1895: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1900: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1905: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1910: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1915: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1920: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1925: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1930: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1935: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1940: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1945: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1950: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1955: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1960: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1965: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1970: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1975: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1980: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1985: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1990: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1995: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2000: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2005: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2010: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2015: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2020: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2025: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2030: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2035: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2040: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2045: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2050: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2055: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2060: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2065: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2070: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2075: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2080: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2085: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2090: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2095: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2100: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2105: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2110: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2115: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2120: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2125: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2130: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2135: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2140: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2145: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2150: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2155: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2160: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2165: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2170: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2175: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2180: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2185: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2190: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2195: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2200: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2205: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2210: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2215: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2220: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2225: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2230: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2235: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2240: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2245: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 2250: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2255: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2260: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2265: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2270: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2275: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2280: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2285: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2290: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2295: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2300: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2305: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2310: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2315: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2320: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2325: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2330: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2335: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2340: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2345: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2350: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2355: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2360: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2365: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2370: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2375: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2380: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2385: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2390: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2395: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2400: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2405: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2410: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2415: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2420: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2425: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2430: 'valid/cross_entropy_loss' was not in top 1
Epoch 3, global step 2435: 'valid/cross_entropy_loss' was not in top 1
Epoch 3/-2 ━━━━━                 185/750 0:00:17 • 0:00:52 10.95it/s v_num: aoli
Restoring states from the checkpoint path at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/er647/anaconda3/envs/fwal/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:492: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.


Best model saved on path ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_train/AUROC_weighted    │         0.6065029048171049          │
│     bestmodel_train/F1_weighted     │         0.6163956908352436          │
│  bestmodel_train/balanced_accuracy  │         0.6065029048171049          │
│ bestmodel_train/cross_entropy_loss  │         0.6183784008026123          │
│ bestmodel_train/precision_weighted  │         0.6389975976223579          │
│   bestmodel_train/recall_weighted   │         0.6081666666666666          │
│ bestmodel_train/reconstruction_loss │         0.5829214453697205          │
│    bestmodel_train/sparsity_loss    │          1.555999994277954          │
│     bestmodel_train/total_loss      │         2.7572999000549316          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 750/750 0:00:01 • 0:00:00 472.16it/s 
Restoring states from the checkpoint path at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_valid/AUROC_weighted    │         0.6104150753718643          │
│     bestmodel_valid/F1_weighted     │         0.6206720003367608          │
│  bestmodel_valid/balanced_accuracy  │         0.6104150753718643          │
│ bestmodel_valid/cross_entropy_loss  │          0.618320107460022          │
│ bestmodel_valid/precision_weighted  │         0.6424067418981482          │
│   bestmodel_valid/recall_weighted   │              0.612625               │
│ bestmodel_valid/reconstruction_loss │          0.582737922668457          │
│    bestmodel_valid/sparsity_loss    │          1.557441234588623          │
│     bestmodel_valid/total_loss      │         2.7584991455078125          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 551.92it/s 
Restoring states from the checkpoint path at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/n779aoli/checkpoints/epoch=1-step=1435.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃            Test metric             ┃            DataLoader 0            ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_test/AUROC_weighted    │         0.6129587702406879         │
│     bestmodel_test/F1_weighted     │         0.6198644368201705         │
│  bestmodel_test/balanced_accuracy  │         0.6129587702406879         │
│ bestmodel_test/cross_entropy_loss  │         0.6181259155273438         │
│ bestmodel_test/precision_weighted  │         0.6451111031656573         │
│   bestmodel_test/recall_weighted   │               0.6115               │
│ bestmodel_test/reconstruction_loss │         0.583867073059082          │
│    bestmodel_test/sparsity_loss    │         1.5549871921539307         │
│     bestmodel_test/total_loss      │         2.7569801807403564         │
└────────────────────────────────────┴────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 561.91it/s 
wandb: - 1.542 MB of 1.948 MB uploadedwandb: \ 1.948 MB of 1.948 MB uploadedwandb: | 1.948 MB of 1.948 MB uploadedwandb: / 1.948 MB of 1.948 MB uploadedwandb: - 1.948 MB of 1.948 MB uploadedwandb: \ 2.006 MB of 2.006 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       bestmodel_test/AUROC_weighted ▁
wandb:          bestmodel_test/F1_weighted ▁
wandb:    bestmodel_test/balanced_accuracy ▁
wandb:   bestmodel_test/cross_entropy_loss ▁
wandb:   bestmodel_test/precision_weighted ▁
wandb:      bestmodel_test/recall_weighted ▁
wandb:  bestmodel_test/reconstruction_loss ▁
wandb:        bestmodel_test/sparsity_loss ▁
wandb:           bestmodel_test/total_loss ▁
wandb:      bestmodel_train/AUROC_weighted ▁
wandb:         bestmodel_train/F1_weighted ▁
wandb:   bestmodel_train/balanced_accuracy ▁
wandb:  bestmodel_train/cross_entropy_loss ▁
wandb:  bestmodel_train/precision_weighted ▁
wandb:     bestmodel_train/recall_weighted ▁
wandb: bestmodel_train/reconstruction_loss ▁
wandb:       bestmodel_train/sparsity_loss ▁
wandb:          bestmodel_train/total_loss ▁
wandb:      bestmodel_valid/AUROC_weighted ▁
wandb:         bestmodel_valid/F1_weighted ▁
wandb:   bestmodel_valid/balanced_accuracy ▁
wandb:  bestmodel_valid/cross_entropy_loss ▁
wandb:  bestmodel_valid/precision_weighted ▁
wandb:     bestmodel_valid/recall_weighted ▁
wandb: bestmodel_valid/reconstruction_loss ▁
wandb:       bestmodel_valid/sparsity_loss ▁
wandb:          bestmodel_valid/total_loss ▁
wandb:                               epoch ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▆▆▆▆▆▆▆▆▆▆▆▆███
wandb:                        lr_scheduler ██▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:                            num_nans ▁▁▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆█
wandb:                train/AUROC_weighted ▁█▆▇
wandb:                   train/F1_weighted ▄█▁▃
wandb:             train/balanced_accuracy ▁█▆▇
wandb:            train/cross_entropy_loss ▆▅▅▃▅▄▆▆▄▄▃▅▅█▄▂▅▆▁▆▄▄▁▃▄▅▄▅▆▃▄▅▃▅▅▃█▄▅▄
wandb:            train/precision_weighted ▁▆██
wandb:               train/recall_weighted ▄█▁▃
wandb:           train/reconstruction_loss ▄█▃▂▃▃▂▇▂▂▃▂▇▂▄▂▂▂▂▃▄▃▂▂▃▅▂▄▂▁▃▄▂▅▆▂▂▂▂▃
wandb:                 train/sparsity_loss ▅▁▁▃▁▅▃▁▃▃▃▃▃█▃▆▃▆▅▃▃▅▅▆▃▁▅▃▅▆▆▃▅▁▁▃▆█▅▅
wandb:                    train/total_loss ▅▃▁▂▁▄▃▂▂▂▃▂▄█▃▆▂▆▄▃▃▅▄▆▃▂▄▃▄▆▆▃▄▂▂▂▆█▄▄
wandb:                 trainer/global_step ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▆▆▆▆▇▇▇▇█████████████
wandb:                valid/AUROC_weighted ▁▁▃▅▅▆▄▆▆▆▅▅▆▅▅▅▅▆▆▆▇▆▅▇▇▇▇█▇▇█▇▆▆▇▇▆▇██
wandb:                   valid/F1_weighted ▅▅▁▃▄▄▄█▇█▇▄██▇█▇▇▃▄▅██▅▆▅▆▆▆█▆██▆▅▅▇▆▆▇
wandb:             valid/balanced_accuracy ▁▁▃▅▅▆▄▆▆▆▅▅▆▅▅▅▅▆▆▆▇▆▅▇▇▇▇█▇▇█▇▆▆▇▇▆▇██
wandb:            valid/cross_entropy_loss █▇▆▄▅▄▆▃▂▄▄▄▃▃▃▄▅▃▄▃▃▃▅▃▂▂▂▂▁▁▂▂▃▂▁▂▃▂▁▁
wandb:            valid/precision_weighted ▁▁▇▇▆▇▅▆▆▆▅▆▆▆▅▅▅▆█▇▇▆▅███▇█▇▆█▆▆▆█▇▆▇█▇
wandb:               valid/recall_weighted ██▁▃▃▃▃▇▆▇▇▃██▇▇▇▇▃▄▄▇█▅▅▄▅▆▆▇▆█▇▆▅▄▇▅▆▇
wandb:           valid/reconstruction_loss █▆▇▆▄▄▆▂▃▃▄▅▄▅▃▄▃▄▄▅▄▄▅▃▂▃▃▂▂▃▂▄▃▄▃▃▄▃▃▁
wandb:                 valid/sparsity_loss ▂▂▁▂▃▄▂▆▄▃▄▂▄▃▄▄▄▂▃▃▃▂▃▄▄▄▄▄▄▄▄▃▄▄▄▄▃▅▄█
wandb:                    valid/total_loss ▃▂▁▂▃▄▂▆▄▂▄▂▃▂▃▃▄▂▃▃▃▂▃▃▃▃▃▄▄▄▄▂▄▄▄▃▃▄▄█
wandb: 
wandb: Run summary:
wandb:                      bestmodel/step 1435
wandb:       bestmodel_test/AUROC_weighted 0.61296
wandb:          bestmodel_test/F1_weighted 0.61986
wandb:    bestmodel_test/balanced_accuracy 0.61296
wandb:   bestmodel_test/cross_entropy_loss 0.61813
wandb:   bestmodel_test/precision_weighted 0.64511
wandb:      bestmodel_test/recall_weighted 0.6115
wandb:  bestmodel_test/reconstruction_loss 0.58387
wandb:        bestmodel_test/sparsity_loss 1.55499
wandb:           bestmodel_test/total_loss 2.75698
wandb:      bestmodel_train/AUROC_weighted 0.6065
wandb:         bestmodel_train/F1_weighted 0.6164
wandb:   bestmodel_train/balanced_accuracy 0.6065
wandb:  bestmodel_train/cross_entropy_loss 0.61838
wandb:  bestmodel_train/precision_weighted 0.639
wandb:     bestmodel_train/recall_weighted 0.60817
wandb: bestmodel_train/reconstruction_loss 0.58292
wandb:       bestmodel_train/sparsity_loss 1.556
wandb:          bestmodel_train/total_loss 2.7573
wandb:      bestmodel_valid/AUROC_weighted 0.61042
wandb:         bestmodel_valid/F1_weighted 0.62067
wandb:   bestmodel_valid/balanced_accuracy 0.61042
wandb:  bestmodel_valid/cross_entropy_loss 0.61832
wandb:  bestmodel_valid/precision_weighted 0.64241
wandb:     bestmodel_valid/recall_weighted 0.61262
wandb: bestmodel_valid/reconstruction_loss 0.58274
wandb:       bestmodel_valid/sparsity_loss 1.55744
wandb:          bestmodel_valid/total_loss 2.7585
wandb:                               epoch 4
wandb:                        lr_scheduler 0.00026
wandb:                            num_nans 11
wandb:                train/AUROC_weighted 0.60725
wandb:                   train/F1_weighted 0.56373
wandb:             train/balanced_accuracy 0.60725
wandb:            train/cross_entropy_loss 0.51334
wandb:            train/precision_weighted 0.65611
wandb:               train/recall_weighted 0.56081
wandb:           train/reconstruction_loss 0.46721
wandb:                 train/sparsity_loss 2.0
wandb:                    train/total_loss 2.98055
wandb:                 trainer/global_step 2435
wandb:                valid/AUROC_weighted 0.64107
wandb:                   valid/F1_weighted 0.63369
wandb:             valid/balanced_accuracy 0.64107
wandb:            valid/cross_entropy_loss 0.6095
wandb:            valid/precision_weighted 0.67304
wandb:               valid/recall_weighted 0.6255
wandb:           valid/reconstruction_loss 0.54569
wandb:                 valid/sparsity_loss 1.4375
wandb:                    valid/total_loss 2.59269
wandb: 
wandb: 🚀 View run distinctive-sweep-30 at: https://wandb.ai/evangeorgerex/fwal/runs/n779aoli
wandb: Synced 3 W&B file(s), 3 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240127_131056-n779aoli/logs

Exiting from train function..
2024-01-27 13:15:36,450 - wandb.wandb_agent - INFO - Cleaning up finished run: n779aoli
2024-01-27 13:15:36,724 - wandb.wandb_agent - INFO - Agent received command: run
2024-01-27 13:15:36,724 - wandb.wandb_agent - INFO - Agent starting run with config:
	dataset: summed_squares_exponential_synth
	mask_init_value: 0
	mask_type: gumbel_softmax
	repeat_id: 0
	seed_model_init: 0
2024-01-27 13:15:36,729 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /home/er647/projects/feature-wise-active-learning/src/run_experiment.py --model fwal --valid_percentage 0.25 --sparsity_type global --gamma 1 --sparsity_regularizer L1 --sparsity_regularizer_hyperparam 1 --test_time_interventions evaluate_test_time_interventions --hpc_run --num_workers 31 --tags c50d3bf6 --notes "Comparing different constant mask initialisations. Gumbel and Softmax. All 5 datasets. x3 test splits x3 weight inits" --dataset=summed_squares_exponential_synth --mask_init_value=0 --mask_type=gumbel_softmax --repeat_id=0 --seed_model_init=0
2024-01-27 13:15:41,740 - wandb.wandb_agent - INFO - Running runs: ['832p7qfn']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: evangeorgerex. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in ./wandb/run-20240127_131544-832p7qfn
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run summer-sweep-31
wandb: ⭐️ View project at https://wandb.ai/evangeorgerex/fwal
wandb: 🧹 View sweep at https://wandb.ai/evangeorgerex/fwal/sweeps/hy72bous
wandb: 🚀 View run at https://wandb.ai/evangeorgerex/fwal/runs/832p7qfn
wandb: WARNING Config item 'dataset' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_type' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'repeat_id' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'seed_model_init' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_init_value' was locked by 'sweep' (ignored update).
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 0
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Starting...

Inside training function

Loading data summed_squares_exponential_synth...
Train size: 6000

Valid size: 2000

Test size: 2000

Weights for the classification loss: [1.4170997 0.7725985]
Train/Valid/Test splits of sizes 6000, 2000, 2000
Num of features: 11
Training for max_epochs = 14
┏━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name                  ┃ Type       ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ reconstruction_module │ Sequential │  8.8 K │
│ 1 │ prediction_module     │ Sequential │  8.4 K │
│   │ other params          │ n/a        │     11 │
└───┴───────────────────────┴────────────┴────────┘
Trainable params: 17.2 K                                                        
Non-trainable params: 0                                                         
Total params: 17.2 K                                                            
Total estimated model params size (MB): 0                                       
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
Epoch 0, global step 5: 'valid/cross_entropy_loss' reached 0.69336 (best 0.69336), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=5.ckpt' as top 1
Epoch 0, global step 10: 'valid/cross_entropy_loss' reached 0.69330 (best 0.69330), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=10.ckpt' as top 1
Epoch 0, global step 15: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 20: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 25: 'valid/cross_entropy_loss' reached 0.69297 (best 0.69297), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=25.ckpt' as top 1
Epoch 0, global step 30: 'valid/cross_entropy_loss' reached 0.69238 (best 0.69238), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=30.ckpt' as top 1
Epoch 0, global step 35: 'valid/cross_entropy_loss' reached 0.69032 (best 0.69032), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=35.ckpt' as top 1
Epoch 0, global step 40: 'valid/cross_entropy_loss' reached 0.68378 (best 0.68378), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=40.ckpt' as top 1
Epoch 0, global step 45: 'valid/cross_entropy_loss' reached 0.66262 (best 0.66262), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=45.ckpt' as top 1
Epoch 0, global step 50: 'valid/cross_entropy_loss' reached 0.62554 (best 0.62554), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=50.ckpt' as top 1
Epoch 0, global step 55: 'valid/cross_entropy_loss' reached 0.59982 (best 0.59982), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=55.ckpt' as top 1
Epoch 0, global step 60: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 65: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 70: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 75: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 80: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 85: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 90: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 95: 'valid/cross_entropy_loss' reached 0.59666 (best 0.59666), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=95.ckpt' as top 1
Epoch 0, global step 100: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 105: 'valid/cross_entropy_loss' reached 0.59288 (best 0.59288), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=105.ckpt' as top 1
Epoch 0, global step 110: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 115: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 120: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 125: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 130: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 135: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 140: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 145: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 150: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 155: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 160: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 165: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 170: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 175: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 180: 'valid/cross_entropy_loss' reached 0.59142 (best 0.59142), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=180.ckpt' as top 1
Epoch 0, global step 185: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 190: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 195: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 200: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 205: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 210: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 215: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 220: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 225: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 230: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 235: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 240: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 245: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 250: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 255: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 260: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 265: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 270: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 275: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 280: 'valid/cross_entropy_loss' reached 0.58503 (best 0.58503), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=280.ckpt' as top 1
Epoch 0, global step 285: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 290: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 295: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 300: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 305: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 310: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 315: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 320: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 325: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 330: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 335: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 340: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 345: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 350: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 355: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 360: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 365: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 370: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 375: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 380: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 385: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 390: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 395: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 400: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 405: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 410: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 415: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 420: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 425: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 430: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 435: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 440: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 445: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 450: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 455: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 460: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 465: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 470: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 475: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 480: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 485: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 490: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 495: 'valid/cross_entropy_loss' reached 0.58241 (best 0.58241), saving model to './fwal/832p7qfn/checkpoints/epoch=0-step=495.ckpt' as top 1
Epoch 0, global step 500: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 505: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 510: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 515: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 520: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 525: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 530: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 535: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 540: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 545: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 550: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 555: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 560: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 565: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 570: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 575: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 580: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 585: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 590: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 595: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 600: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 605: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 610: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 615: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 620: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 625: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 630: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 635: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 640: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 645: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 650: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 655: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 660: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 665: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 670: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 675: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 680: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 685: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 690: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 695: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 700: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 705: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 710: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 715: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 720: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 725: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 730: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 735: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 740: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 745: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 750: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 755: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 760: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 765: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 770: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 775: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 780: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 785: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 790: 'valid/cross_entropy_loss' reached 0.57545 (best 0.57545), saving model to './fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt' as top 1
Epoch 1, global step 795: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 800: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 805: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 810: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 815: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 820: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 825: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 830: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 835: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 840: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 845: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 850: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 855: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 860: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 865: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 870: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 875: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 880: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 885: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 890: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 895: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 900: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 905: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 910: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 915: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 920: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 925: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 930: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 935: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 940: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 945: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 950: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 955: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 960: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 965: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 970: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 975: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 980: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 985: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 990: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 995: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1000: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1005: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1010: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1015: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1020: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1025: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1030: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1035: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1040: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1045: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1050: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1055: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1060: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1065: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1070: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1075: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1080: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1085: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1090: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1095: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1100: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1105: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1110: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1115: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1120: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1125: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1130: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1135: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1140: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1145: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1150: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1155: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1160: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1165: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1170: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1175: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1180: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1185: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1190: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1195: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1200: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1205: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1210: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1215: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1220: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1225: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1230: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1235: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1240: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1245: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1250: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1255: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1260: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1265: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1270: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1275: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1280: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1285: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1290: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1295: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1300: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1305: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1310: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1315: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1320: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1325: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1330: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1335: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1340: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1345: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1350: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1355: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1360: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1365: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1370: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1375: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1380: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1385: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1390: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1395: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1400: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1405: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1410: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1415: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1420: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1425: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1430: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1435: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1440: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1445: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1450: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1455: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1460: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1465: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1470: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1475: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1480: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1485: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1490: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1495: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1500: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1505: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1510: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1515: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1520: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1525: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1530: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1535: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1540: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1545: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1550: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1555: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1560: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1565: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1570: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1575: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1580: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1585: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1590: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1595: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1600: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1605: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1610: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1615: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1620: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1625: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1630: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1635: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1640: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1645: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1650: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1655: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1660: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1665: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1670: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1675: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1680: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1685: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1690: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1695: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1700: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1705: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1710: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1715: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1720: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1725: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1730: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1735: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1740: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1745: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1750: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1755: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1760: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1765: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1770: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1775: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1780: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1785: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1790: 'valid/cross_entropy_loss' was not in top 1
Epoch 2/-2 ━━━━━━━━              290/750 0:00:27 • 0:00:43 10.87it/s v_num: 7qfn
Restoring states from the checkpoint path at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/er647/anaconda3/envs/fwal/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:492: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.


Best model saved on path ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_train/AUROC_weighted    │         0.6404540533807055          │
│     bestmodel_train/F1_weighted     │          0.565867415199745          │
│  bestmodel_train/balanced_accuracy  │         0.6404540533807054          │
│ bestmodel_train/cross_entropy_loss  │         0.6042523384094238          │
│ bestmodel_train/precision_weighted  │         0.7102801051513336          │
│   bestmodel_train/recall_weighted   │         0.5721666666666667          │
│ bestmodel_train/reconstruction_loss │         0.4762159287929535          │
│    bestmodel_train/sparsity_loss    │         2.7266666889190674          │
│     bestmodel_train/total_loss      │         3.8071348667144775          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 750/750 0:00:01 • 0:00:00 502.52it/s 
Restoring states from the checkpoint path at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_valid/AUROC_weighted    │         0.6325869737334491          │
│     bestmodel_valid/F1_weighted     │         0.5547944513284162          │
│  bestmodel_valid/balanced_accuracy  │         0.6325869737334491          │
│ bestmodel_valid/cross_entropy_loss  │         0.6047425866127014          │
│ bestmodel_valid/precision_weighted  │         0.7039487974042266          │
│   bestmodel_valid/recall_weighted   │              0.562625               │
│ bestmodel_valid/reconstruction_loss │         0.47775906324386597         │
│    bestmodel_valid/sparsity_loss    │         2.7232375144958496          │
│     bestmodel_valid/total_loss      │          3.805739164352417          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 565.60it/s 
Restoring states from the checkpoint path at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/832p7qfn/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃            Test metric             ┃            DataLoader 0            ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_test/AUROC_weighted    │         0.6343858000554982         │
│     bestmodel_test/F1_weighted     │         0.556552729147771          │
│  bestmodel_test/balanced_accuracy  │         0.634385800055498          │
│ bestmodel_test/cross_entropy_loss  │         0.6046499013900757         │
│ bestmodel_test/precision_weighted  │         0.7060673229414844         │
│   bestmodel_test/recall_weighted   │               0.5643               │
│ bestmodel_test/reconstruction_loss │        0.47767874598503113         │
│    bestmodel_test/sparsity_loss    │         2.723785161972046          │
│     bestmodel_test/total_loss      │         3.8061137199401855         │
└────────────────────────────────────┴────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 560.04it/s 
wandb: - 1.538 MB of 1.942 MB uploadedwandb: \ 1.942 MB of 1.942 MB uploadedwandb: | 1.942 MB of 1.990 MB uploadedwandb: / 1.942 MB of 1.990 MB uploadedwandb: - 1.990 MB of 1.990 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       bestmodel_test/AUROC_weighted ▁
wandb:          bestmodel_test/F1_weighted ▁
wandb:    bestmodel_test/balanced_accuracy ▁
wandb:   bestmodel_test/cross_entropy_loss ▁
wandb:   bestmodel_test/precision_weighted ▁
wandb:      bestmodel_test/recall_weighted ▁
wandb:  bestmodel_test/reconstruction_loss ▁
wandb:        bestmodel_test/sparsity_loss ▁
wandb:           bestmodel_test/total_loss ▁
wandb:      bestmodel_train/AUROC_weighted ▁
wandb:         bestmodel_train/F1_weighted ▁
wandb:   bestmodel_train/balanced_accuracy ▁
wandb:  bestmodel_train/cross_entropy_loss ▁
wandb:  bestmodel_train/precision_weighted ▁
wandb:     bestmodel_train/recall_weighted ▁
wandb: bestmodel_train/reconstruction_loss ▁
wandb:       bestmodel_train/sparsity_loss ▁
wandb:          bestmodel_train/total_loss ▁
wandb:      bestmodel_valid/AUROC_weighted ▁
wandb:         bestmodel_valid/F1_weighted ▁
wandb:   bestmodel_valid/balanced_accuracy ▁
wandb:  bestmodel_valid/cross_entropy_loss ▁
wandb:  bestmodel_valid/precision_weighted ▁
wandb:     bestmodel_valid/recall_weighted ▁
wandb: bestmodel_valid/reconstruction_loss ▁
wandb:       bestmodel_valid/sparsity_loss ▁
wandb:          bestmodel_valid/total_loss ▁
wandb:                               epoch ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅██████
wandb:                        lr_scheduler ██▇▇▇▆▆▆▆▅▅▅▅▄▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:                            num_nans ▁▁▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆█
wandb:                train/AUROC_weighted ▂▁█
wandb:                   train/F1_weighted ▁█▂
wandb:             train/balanced_accuracy ▂▁█
wandb:            train/cross_entropy_loss ▅▄▄▄▁▄▄▅▃▅▃▄▄▄▄▅▁▄▃▃▆▄▄█▃▄▇▅▃▄▆▃▅▄▂▅▄▅▃▄
wandb:            train/precision_weighted ▄▁█
wandb:               train/recall_weighted ▁█▆
wandb:           train/reconstruction_loss ▂▁▁▁▁▁▂▁▁▂▂▂▁▁▃▁▂▂▂▂▁▂▆▁▁▁▁▃▁▂▂▂█▂▂▂▁▆▁▂
wandb:                 train/sparsity_loss ▃█▇▇▇▅▅▅▆▂▂▃▆▃▂▆▆▇▂▅▅▃▂▆█▅▇▁▆▅▂▅▁▃▇▅▇▂▆▃
wandb:                    train/total_loss ▃█▇▇▆▄▄▄▅▂▂▃▅▃▂▆▅▇▂▄▄▃▄▆█▄▇▁▅▄▂▄▄▃▇▄▇▄▅▃
wandb:                 trainer/global_step ▁▁▁▂▂▂▃▃▃▃▄▄▄▄▅▅▅▆▆▆▆▇▇▇▇███████████████
wandb:                valid/AUROC_weighted ▁█▇█▇▆██▇▆██▇▇█▇▇▅▇▆▇▆▅▅▇▆▆▆██▆▇▇▇▇▇▇█▇▇
wandb:                   valid/F1_weighted ▁▄▁▄▄▁▅▆▇█▆▆▂▆▄▃▇▇█▇▇▇▇▃▃▂▂▂▅▄▇▂▄▂▃▃▄▆▆▄
wandb:             valid/balanced_accuracy ▁█▇█▇▆██▇▆██▇▇█▇▇▅▇▆▇▆▅▅▇▆▆▆██▆▇▇▇▇▇▇█▇▇
wandb:            valid/cross_entropy_loss █▂▃▂▂▃▁▂▄▃▁▁▃▂▂▃▂▅▂▂▃▂▄▄▂▃▃▃▁▁▃▃▂▃▂▃▂▂▂▂
wandb:            valid/precision_weighted ▁███▇█▇▇▆▆▇▇▇▇█▇▆▅▆▆▆▆▅▆▇▇▆▇▇▇▆▇▇▇▇▇▇▇▆▇
wandb:               valid/recall_weighted █▄▁▄▃▁▅▅▆▇▆▆▂▅▄▃▇▇█▇▇▇▇▂▃▂▂▁▄▄▆▂▄▂▂▂▄▅▅▄
wandb:           valid/reconstruction_loss ▅▃▂▂▃▄▃▃▃▄▁▃▄▃▄▅▅▇▅▄▆▅▅█▅▆▇▆▄▄▇▆▄▇▆▅▅▅▅▆
wandb:                 valid/sparsity_loss ██▆▆▅▅▅▅▅▅▆▅▃▃▃▃▂▃▂▄▂▃▃▁▂▂▂▂▂▃▂▂▃▁▁▃▂▂▂▂
wandb:                    valid/total_loss █▇▆▆▄▄▅▅▅▄▅▅▃▃▃▃▂▃▂▄▂▃▃▁▂▂▂▂▂▃▂▂▂▁▁▂▂▂▁▁
wandb: 
wandb: Run summary:
wandb:                      bestmodel/step 790
wandb:       bestmodel_test/AUROC_weighted 0.63439
wandb:          bestmodel_test/F1_weighted 0.55655
wandb:    bestmodel_test/balanced_accuracy 0.63439
wandb:   bestmodel_test/cross_entropy_loss 0.60465
wandb:   bestmodel_test/precision_weighted 0.70607
wandb:      bestmodel_test/recall_weighted 0.5643
wandb:  bestmodel_test/reconstruction_loss 0.47768
wandb:        bestmodel_test/sparsity_loss 2.72379
wandb:           bestmodel_test/total_loss 3.80611
wandb:      bestmodel_train/AUROC_weighted 0.64045
wandb:         bestmodel_train/F1_weighted 0.56587
wandb:   bestmodel_train/balanced_accuracy 0.64045
wandb:  bestmodel_train/cross_entropy_loss 0.60425
wandb:  bestmodel_train/precision_weighted 0.71028
wandb:     bestmodel_train/recall_weighted 0.57217
wandb: bestmodel_train/reconstruction_loss 0.47622
wandb:       bestmodel_train/sparsity_loss 2.72667
wandb:          bestmodel_train/total_loss 3.80713
wandb:      bestmodel_valid/AUROC_weighted 0.63259
wandb:         bestmodel_valid/F1_weighted 0.55479
wandb:   bestmodel_valid/balanced_accuracy 0.63259
wandb:  bestmodel_valid/cross_entropy_loss 0.60474
wandb:  bestmodel_valid/precision_weighted 0.70395
wandb:     bestmodel_valid/recall_weighted 0.56263
wandb: bestmodel_valid/reconstruction_loss 0.47776
wandb:       bestmodel_valid/sparsity_loss 2.72324
wandb:          bestmodel_valid/total_loss 3.80574
wandb:                               epoch 3
wandb:                        lr_scheduler 0.0005
wandb:                            num_nans 11
wandb:                train/AUROC_weighted 0.63576
wandb:                   train/F1_weighted 0.56792
wandb:             train/balanced_accuracy 0.63576
wandb:            train/cross_entropy_loss 0.722
wandb:            train/precision_weighted 0.69886
wandb:               train/recall_weighted 0.57328
wandb:           train/reconstruction_loss 0.48031
wandb:                 train/sparsity_loss 2.0
wandb:                    train/total_loss 3.20231
wandb:                 trainer/global_step 1790
wandb:                valid/AUROC_weighted 0.65934
wandb:                   valid/F1_weighted 0.58031
wandb:             valid/balanced_accuracy 0.65934
wandb:            valid/cross_entropy_loss 0.60332
wandb:            valid/precision_weighted 0.73572
wandb:               valid/recall_weighted 0.5875
wandb:           valid/reconstruction_loss 0.44249
wandb:                 valid/sparsity_loss 2.6875
wandb:                    valid/total_loss 3.73331
wandb: 
wandb: 🚀 View run summer-sweep-31 at: https://wandb.ai/evangeorgerex/fwal/runs/832p7qfn
wandb: Synced 3 W&B file(s), 3 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240127_131544-832p7qfn/logs

Exiting from train function..
2024-01-27 13:19:30,410 - wandb.wandb_agent - INFO - Cleaning up finished run: 832p7qfn
2024-01-27 13:19:30,706 - wandb.wandb_agent - INFO - Agent received command: run
2024-01-27 13:19:30,707 - wandb.wandb_agent - INFO - Agent starting run with config:
	dataset: summed_squares_exponential_synth
	mask_init_value: 0
	mask_type: gumbel_softmax
	repeat_id: 0
	seed_model_init: 1
2024-01-27 13:19:30,711 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /home/er647/projects/feature-wise-active-learning/src/run_experiment.py --model fwal --valid_percentage 0.25 --sparsity_type global --gamma 1 --sparsity_regularizer L1 --sparsity_regularizer_hyperparam 1 --test_time_interventions evaluate_test_time_interventions --hpc_run --num_workers 31 --tags c50d3bf6 --notes "Comparing different constant mask initialisations. Gumbel and Softmax. All 5 datasets. x3 test splits x3 weight inits" --dataset=summed_squares_exponential_synth --mask_init_value=0 --mask_type=gumbel_softmax --repeat_id=0 --seed_model_init=1
2024-01-27 13:19:35,721 - wandb.wandb_agent - INFO - Running runs: ['hrtl1ibr']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: evangeorgerex. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in ./wandb/run-20240127_131938-hrtl1ibr
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run cerulean-sweep-32
wandb: ⭐️ View project at https://wandb.ai/evangeorgerex/fwal
wandb: 🧹 View sweep at https://wandb.ai/evangeorgerex/fwal/sweeps/hy72bous
wandb: 🚀 View run at https://wandb.ai/evangeorgerex/fwal/runs/hrtl1ibr
wandb: WARNING Config item 'dataset' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_type' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'repeat_id' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'seed_model_init' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_init_value' was locked by 'sweep' (ignored update).
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 1
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Starting...

Inside training function

Loading data summed_squares_exponential_synth...
Train size: 6000

Valid size: 2000

Test size: 2000

Weights for the classification loss: [1.4170997 0.7725985]
Train/Valid/Test splits of sizes 6000, 2000, 2000
Num of features: 11
Training for max_epochs = 14
┏━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name                  ┃ Type       ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ reconstruction_module │ Sequential │  8.8 K │
│ 1 │ prediction_module     │ Sequential │  8.4 K │
│   │ other params          │ n/a        │     11 │
└───┴───────────────────────┴────────────┴────────┘
Trainable params: 17.2 K                                                        
Non-trainable params: 0                                                         
Total params: 17.2 K                                                            
Total estimated model params size (MB): 0                                       
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
Epoch 0, global step 5: 'valid/cross_entropy_loss' reached 0.69380 (best 0.69380), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=5.ckpt' as top 1
Epoch 0, global step 10: 'valid/cross_entropy_loss' reached 0.69316 (best 0.69316), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=10.ckpt' as top 1
Epoch 0, global step 15: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 20: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 25: 'valid/cross_entropy_loss' reached 0.69158 (best 0.69158), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=25.ckpt' as top 1
Epoch 0, global step 30: 'valid/cross_entropy_loss' reached 0.68904 (best 0.68904), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=30.ckpt' as top 1
Epoch 0, global step 35: 'valid/cross_entropy_loss' reached 0.68381 (best 0.68381), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=35.ckpt' as top 1
Epoch 0, global step 40: 'valid/cross_entropy_loss' reached 0.67480 (best 0.67480), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=40.ckpt' as top 1
Epoch 0, global step 45: 'valid/cross_entropy_loss' reached 0.65760 (best 0.65760), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=45.ckpt' as top 1
Epoch 0, global step 50: 'valid/cross_entropy_loss' reached 0.62596 (best 0.62596), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=50.ckpt' as top 1
Epoch 0, global step 55: 'valid/cross_entropy_loss' reached 0.61611 (best 0.61611), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=55.ckpt' as top 1
Epoch 0, global step 60: 'valid/cross_entropy_loss' reached 0.58149 (best 0.58149), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=60.ckpt' as top 1
Epoch 0, global step 65: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 70: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 75: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 80: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 85: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 90: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 95: 'valid/cross_entropy_loss' reached 0.57979 (best 0.57979), saving model to './fwal/hrtl1ibr/checkpoints/epoch=0-step=95.ckpt' as top 1
Epoch 0, global step 100: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 105: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 110: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 115: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 120: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 125: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 130: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 135: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 140: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 145: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 150: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 155: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 160: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 165: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 170: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 175: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 180: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 185: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 190: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 195: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 200: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 205: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 210: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 215: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 220: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 225: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 230: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 235: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 240: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 245: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 250: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 255: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 260: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 265: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 270: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 275: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 280: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 285: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 290: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 295: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 300: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 305: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 310: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 315: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 320: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 325: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 330: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 335: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 340: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 345: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 350: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 355: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 360: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 365: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 370: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 375: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 380: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 385: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 390: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 395: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 400: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 405: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 410: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 415: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 420: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 425: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 430: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 435: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 440: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 445: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 450: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 455: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 460: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 465: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 470: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 475: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 480: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 485: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 490: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 495: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 500: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 505: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 510: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 515: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 520: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 525: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 530: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 535: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 540: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 545: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 550: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 555: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 560: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 565: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 570: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 575: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 580: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 585: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 590: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 595: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 600: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 605: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 610: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 615: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 620: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 625: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 630: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 635: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 640: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 645: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 650: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 655: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 660: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 665: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 670: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 675: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 680: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 685: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 690: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 695: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 700: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 705: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 710: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 715: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 720: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 725: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 730: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 735: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 740: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 745: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 750: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 755: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 760: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 765: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 770: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 775: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 780: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 785: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 790: 'valid/cross_entropy_loss' reached 0.57597 (best 0.57597), saving model to './fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt' as top 1
Epoch 1, global step 795: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 800: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 805: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 810: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 815: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 820: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 825: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 830: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 835: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 840: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 845: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 850: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 855: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 860: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 865: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 870: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 875: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 880: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 885: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 890: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 895: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 900: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 905: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 910: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 915: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 920: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 925: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 930: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 935: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 940: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 945: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 950: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 955: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 960: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 965: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 970: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 975: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 980: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 985: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 990: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 995: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1000: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1005: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1010: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1015: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1020: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1025: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1030: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1035: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1040: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1045: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1050: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1055: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1060: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1065: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1070: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1075: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1080: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1085: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1090: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1095: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1100: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1105: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1110: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1115: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1120: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1125: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1130: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1135: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1140: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1145: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1150: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1155: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1160: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1165: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1170: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1175: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1180: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1185: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1190: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1195: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1200: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1205: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1210: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1215: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1220: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1225: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1230: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1235: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1240: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1245: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1250: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1255: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1260: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1265: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1270: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1275: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1280: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1285: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1290: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1295: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1300: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1305: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1310: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1315: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1320: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1325: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1330: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1335: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1340: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1345: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1350: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1355: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1360: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1365: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1370: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1375: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1380: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1385: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1390: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1395: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1400: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1405: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1410: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1415: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1420: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1425: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1430: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1435: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1440: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1445: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1450: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1455: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1460: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1465: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1470: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1475: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1480: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1485: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1490: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1495: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1500: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1505: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1510: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1515: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1520: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1525: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1530: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1535: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1540: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1545: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1550: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1555: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1560: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1565: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1570: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1575: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1580: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1585: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1590: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1595: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1600: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1605: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1610: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1615: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1620: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1625: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1630: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1635: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1640: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1645: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1650: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1655: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1660: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1665: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1670: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1675: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1680: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1685: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1690: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1695: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1700: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1705: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1710: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1715: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1720: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1725: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1730: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1735: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1740: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1745: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1750: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1755: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1760: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1765: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1770: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1775: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1780: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1785: 'valid/cross_entropy_loss' was not in top 1
Epoch 2, global step 1790: 'valid/cross_entropy_loss' was not in top 1
Epoch 2/-2 ━━━━━━━━              290/750 0:00:28 • 0:00:44 10.66it/s v_num: 1ibr
Restoring states from the checkpoint path at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/er647/anaconda3/envs/fwal/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:492: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.


Best model saved on path ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_train/AUROC_weighted    │         0.6369046134629214          │
│     bestmodel_train/F1_weighted     │         0.5763587193323018          │
│  bestmodel_train/balanced_accuracy  │         0.6369046134629213          │
│ bestmodel_train/cross_entropy_loss  │         0.6041386127471924          │
│ bestmodel_train/precision_weighted  │         0.6956968736011536          │
│   bestmodel_train/recall_weighted   │                0.578                │
│ bestmodel_train/reconstruction_loss │         0.4696304500102997          │
│    bestmodel_train/sparsity_loss    │         2.7239999771118164          │
│     bestmodel_train/total_loss      │          3.797769069671631          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 750/750 0:00:01 • 0:00:00 472.16it/s 
Restoring states from the checkpoint path at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             Test metric             ┃            DataLoader 0             ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_valid/AUROC_weighted    │         0.6316973881930015          │
│     bestmodel_valid/F1_weighted     │         0.5669316549655075          │
│  bestmodel_valid/balanced_accuracy  │         0.6316973881930015          │
│ bestmodel_valid/cross_entropy_loss  │         0.6045141816139221          │
│ bestmodel_valid/precision_weighted  │         0.6930731897314079          │
│   bestmodel_valid/recall_weighted   │              0.570125               │
│ bestmodel_valid/reconstruction_loss │         0.47120413184165955         │
│    bestmodel_valid/sparsity_loss    │         2.7206265926361084          │
│     bestmodel_valid/total_loss      │         3.7963449954986572          │
└─────────────────────────────────────┴─────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 569.35it/s 
Restoring states from the checkpoint path at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ./fwal/hrtl1ibr/checkpoints/epoch=1-step=790.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃            Test metric             ┃            DataLoader 0            ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│   bestmodel_test/AUROC_weighted    │         0.6345830565435898         │
│     bestmodel_test/F1_weighted     │         0.5698240766004316         │
│  bestmodel_test/balanced_accuracy  │         0.6345830565435898         │
│ bestmodel_test/cross_entropy_loss  │         0.604406476020813          │
│ bestmodel_test/precision_weighted  │         0.6962011200177776         │
│   bestmodel_test/recall_weighted   │               0.5729               │
│ bestmodel_test/reconstruction_loss │         0.4710913300514221         │
│    bestmodel_test/sparsity_loss    │         2.7212276458740234         │
│     bestmodel_test/total_loss      │         3.7967255115509033         │
└────────────────────────────────────┴────────────────────────────────────┘
Testing ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16/16 0:00:00 • 0:00:00 579.29it/s 
wandb: - 1.536 MB of 1.940 MB uploadedwandb: \ 1.940 MB of 1.988 MB uploadedwandb: | 1.940 MB of 1.988 MB uploadedwandb: / 1.988 MB of 1.988 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       bestmodel_test/AUROC_weighted ▁
wandb:          bestmodel_test/F1_weighted ▁
wandb:    bestmodel_test/balanced_accuracy ▁
wandb:   bestmodel_test/cross_entropy_loss ▁
wandb:   bestmodel_test/precision_weighted ▁
wandb:      bestmodel_test/recall_weighted ▁
wandb:  bestmodel_test/reconstruction_loss ▁
wandb:        bestmodel_test/sparsity_loss ▁
wandb:           bestmodel_test/total_loss ▁
wandb:      bestmodel_train/AUROC_weighted ▁
wandb:         bestmodel_train/F1_weighted ▁
wandb:   bestmodel_train/balanced_accuracy ▁
wandb:  bestmodel_train/cross_entropy_loss ▁
wandb:  bestmodel_train/precision_weighted ▁
wandb:     bestmodel_train/recall_weighted ▁
wandb: bestmodel_train/reconstruction_loss ▁
wandb:       bestmodel_train/sparsity_loss ▁
wandb:          bestmodel_train/total_loss ▁
wandb:      bestmodel_valid/AUROC_weighted ▁
wandb:         bestmodel_valid/F1_weighted ▁
wandb:   bestmodel_valid/balanced_accuracy ▁
wandb:  bestmodel_valid/cross_entropy_loss ▁
wandb:  bestmodel_valid/precision_weighted ▁
wandb:     bestmodel_valid/recall_weighted ▁
wandb: bestmodel_valid/reconstruction_loss ▁
wandb:       bestmodel_valid/sparsity_loss ▁
wandb:          bestmodel_valid/total_loss ▁
wandb:                               epoch ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅██████
wandb:                        lr_scheduler ██▇▇▇▆▆▆▆▅▅▅▅▄▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:                            num_nans ▁▁▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆█
wandb:                train/AUROC_weighted ▄▁█
wandb:                   train/F1_weighted ▂█▁
wandb:             train/balanced_accuracy ▄▁█
wandb:            train/cross_entropy_loss ▅▄▄▄▁▄▄▄▂▄▃▃▄▄▃▄▁▄▃▃▅▃▄█▃▃▇▅▃▄▅▃▅▃▃▄▄▄▃▄
wandb:            train/precision_weighted ▅▁█
wandb:               train/recall_weighted ▁█▅
wandb:           train/reconstruction_loss ▂▁▁▁▁▁▁▁▁▂▂▁▁▁▂▁▂▂▂▂▁▃▆▁▁▁▁▃▁▂▂▂█▂▂▂▁▆▁▂
wandb:                 train/sparsity_loss ▃█▇▇▇▅▅▅▆▂▂▃▆▃▂▆▆▇▂▅▅▃▂▆█▅▇▁▆▅▂▅▁▃▇▆▇▂▆▃
wandb:                    train/total_loss ▃█▇▇▇▄▄▄▅▂▂▃▅▃▂▆▅▇▂▄▄▄▄▆█▄▇▁▅▄▂▄▄▃▇▆▇▄▅▃
wandb:                 trainer/global_step ▁▁▁▂▂▂▃▃▃▃▄▄▄▄▅▅▅▆▆▆▆▇▇▇▇███████████████
wandb:                valid/AUROC_weighted ▁█▇▇▇▆█▇▇▆██▇▇▇▆▆▅▆▇▇▇▅▅▇▆▆▆▇▇▆▇▇▆▆▆▆▇▅▇
wandb:                   valid/F1_weighted ▁▇▄▃▄▂▆▅▇█▇▇▃▇▅▃▇▇█▆▄▆▇▂▅▃▃▂▆▅▄▃▆▃▃▂▃▆▃▅
wandb:             valid/balanced_accuracy ▁█▇▇▇▆█▇▇▆██▇▇▇▆▆▅▆▇▇▇▅▅▇▆▆▆▇▇▆▇▇▆▆▆▆▇▅▇
wandb:            valid/cross_entropy_loss █▁▂▂▂▃▁▂▄▃▁▁▃▃▂▃▂▄▃▂▃▂▄▄▂▃▃▄▁▂▃▃▂▄▃▃▂▂▃▂
wandb:            valid/precision_weighted ▁███████▆▆▇▇▇▇█▇▆▅▆▆▇▇▆▇▇▇▇▇▇█▇█▇▇▇▇▇▇▆▇
wandb:               valid/recall_weighted █▆▄▃▄▁▅▄▆▇▆▆▃▆▅▃▆▆█▅▃▅▇▁▅▂▂▁▅▄▄▃▅▂▃▂▃▅▂▄
wandb:           valid/reconstruction_loss ▅▂▂▁▃▄▃▃▃▄▁▃▄▃▄▅▅▇▆▄▆▅▅█▄▆▇▇▄▄▇▆▄▇▆▅▅▅▇▅
wandb:                 valid/sparsity_loss ██▆▆▄▄▅▅▅▅▅▅▃▃▃▃▂▂▂▄▂▃▃▁▂▂▂▂▂▃▂▂▃▁▁▂▂▂▁▂
wandb:                    valid/total_loss █▇▆▆▄▄▅▄▅▄▅▅▃▃▃▃▂▂▁▄▂▃▃▁▂▁▂▂▂▃▂▂▂▁▁▂▂▂▁▁
wandb: 
wandb: Run summary:
wandb:                      bestmodel/step 790
wandb:       bestmodel_test/AUROC_weighted 0.63458
wandb:          bestmodel_test/F1_weighted 0.56982
wandb:    bestmodel_test/balanced_accuracy 0.63458
wandb:   bestmodel_test/cross_entropy_loss 0.60441
wandb:   bestmodel_test/precision_weighted 0.6962
wandb:      bestmodel_test/recall_weighted 0.5729
wandb:  bestmodel_test/reconstruction_loss 0.47109
wandb:        bestmodel_test/sparsity_loss 2.72123
wandb:           bestmodel_test/total_loss 3.79673
wandb:      bestmodel_train/AUROC_weighted 0.6369
wandb:         bestmodel_train/F1_weighted 0.57636
wandb:   bestmodel_train/balanced_accuracy 0.6369
wandb:  bestmodel_train/cross_entropy_loss 0.60414
wandb:  bestmodel_train/precision_weighted 0.6957
wandb:     bestmodel_train/recall_weighted 0.578
wandb: bestmodel_train/reconstruction_loss 0.46963
wandb:       bestmodel_train/sparsity_loss 2.724
wandb:          bestmodel_train/total_loss 3.79777
wandb:      bestmodel_valid/AUROC_weighted 0.6317
wandb:         bestmodel_valid/F1_weighted 0.56693
wandb:   bestmodel_valid/balanced_accuracy 0.6317
wandb:  bestmodel_valid/cross_entropy_loss 0.60451
wandb:  bestmodel_valid/precision_weighted 0.69307
wandb:     bestmodel_valid/recall_weighted 0.57012
wandb: bestmodel_valid/reconstruction_loss 0.4712
wandb:       bestmodel_valid/sparsity_loss 2.72063
wandb:          bestmodel_valid/total_loss 3.79634
wandb:                               epoch 3
wandb:                        lr_scheduler 0.0005
wandb:                            num_nans 11
wandb:                train/AUROC_weighted 0.63657
wandb:                   train/F1_weighted 0.57019
wandb:             train/balanced_accuracy 0.63657
wandb:            train/cross_entropy_loss 0.71076
wandb:            train/precision_weighted 0.69862
wandb:               train/recall_weighted 0.575
wandb:           train/reconstruction_loss 0.47348
wandb:                 train/sparsity_loss 2.0
wandb:                    train/total_loss 3.18424
wandb:                 trainer/global_step 1790
wandb:                valid/AUROC_weighted 0.66056
wandb:                   valid/F1_weighted 0.58669
wandb:             valid/balanced_accuracy 0.66056
wandb:            valid/cross_entropy_loss 0.60127
wandb:            valid/precision_weighted 0.73208
wandb:               valid/recall_weighted 0.592
wandb:           valid/reconstruction_loss 0.43812
wandb:                 valid/sparsity_loss 2.75
wandb:                    valid/total_loss 3.78939
wandb: 
wandb: 🚀 View run cerulean-sweep-32 at: https://wandb.ai/evangeorgerex/fwal/runs/hrtl1ibr
wandb: Synced 3 W&B file(s), 3 media file(s), 3 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240127_131938-hrtl1ibr/logs

Exiting from train function..
2024-01-27 13:23:21,790 - wandb.wandb_agent - INFO - Cleaning up finished run: hrtl1ibr
2024-01-27 13:23:22,101 - wandb.wandb_agent - INFO - Agent received command: run
2024-01-27 13:23:22,101 - wandb.wandb_agent - INFO - Agent starting run with config:
	dataset: summed_squares_exponential_synth
	mask_init_value: 0
	mask_type: gumbel_softmax
	repeat_id: 0
	seed_model_init: 2
2024-01-27 13:23:22,105 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /home/er647/projects/feature-wise-active-learning/src/run_experiment.py --model fwal --valid_percentage 0.25 --sparsity_type global --gamma 1 --sparsity_regularizer L1 --sparsity_regularizer_hyperparam 1 --test_time_interventions evaluate_test_time_interventions --hpc_run --num_workers 31 --tags c50d3bf6 --notes "Comparing different constant mask initialisations. Gumbel and Softmax. All 5 datasets. x3 test splits x3 weight inits" --dataset=summed_squares_exponential_synth --mask_init_value=0 --mask_type=gumbel_softmax --repeat_id=0 --seed_model_init=2
2024-01-27 13:23:27,116 - wandb.wandb_agent - INFO - Running runs: ['2j4rnfq3']
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: evangeorgerex. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in ./wandb/run-20240127_132329-2j4rnfq3
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run comic-sweep-33
wandb: ⭐️ View project at https://wandb.ai/evangeorgerex/fwal
wandb: 🧹 View sweep at https://wandb.ai/evangeorgerex/fwal/sweeps/hy72bous
wandb: 🚀 View run at https://wandb.ai/evangeorgerex/fwal/runs/2j4rnfq3
wandb: WARNING Config item 'dataset' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_type' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'repeat_id' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'seed_model_init' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'mask_init_value' was locked by 'sweep' (ignored update).
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Seed set to 2
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Starting...

Inside training function

Loading data summed_squares_exponential_synth...
Train size: 6000

Valid size: 2000

Test size: 2000

Weights for the classification loss: [1.4170997 0.7725985]
Train/Valid/Test splits of sizes 6000, 2000, 2000
Num of features: 11
Training for max_epochs = 14
┏━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name                  ┃ Type       ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ reconstruction_module │ Sequential │  8.8 K │
│ 1 │ prediction_module     │ Sequential │  8.4 K │
│   │ other params          │ n/a        │     11 │
└───┴───────────────────────┴────────────┴────────┘
Trainable params: 17.2 K                                                        
Non-trainable params: 0                                                         
Total params: 17.2 K                                                            
Total estimated model params size (MB): 0                                       
SLURM auto-requeueing enabled. Setting signal handlers.
Created 1 validation dataloaders.
Epoch 0, global step 5: 'valid/cross_entropy_loss' reached 0.69366 (best 0.69366), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=5.ckpt' as top 1
Epoch 0, global step 10: 'valid/cross_entropy_loss' reached 0.69334 (best 0.69334), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=10.ckpt' as top 1
Epoch 0, global step 15: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 20: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 25: 'valid/cross_entropy_loss' reached 0.69282 (best 0.69282), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=25.ckpt' as top 1
Epoch 0, global step 30: 'valid/cross_entropy_loss' reached 0.69278 (best 0.69278), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=30.ckpt' as top 1
Epoch 0, global step 35: 'valid/cross_entropy_loss' reached 0.69227 (best 0.69227), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=35.ckpt' as top 1
Epoch 0, global step 40: 'valid/cross_entropy_loss' reached 0.68840 (best 0.68840), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=40.ckpt' as top 1
Epoch 0, global step 45: 'valid/cross_entropy_loss' reached 0.67234 (best 0.67234), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=45.ckpt' as top 1
Epoch 0, global step 50: 'valid/cross_entropy_loss' reached 0.63474 (best 0.63474), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=50.ckpt' as top 1
Epoch 0, global step 55: 'valid/cross_entropy_loss' reached 0.60778 (best 0.60778), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=55.ckpt' as top 1
Epoch 0, global step 60: 'valid/cross_entropy_loss' reached 0.59134 (best 0.59134), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=60.ckpt' as top 1
Epoch 0, global step 65: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 70: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 75: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 80: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 85: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 90: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 95: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 100: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 105: 'valid/cross_entropy_loss' reached 0.59047 (best 0.59047), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=105.ckpt' as top 1
Epoch 0, global step 110: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 115: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 120: 'valid/cross_entropy_loss' reached 0.58988 (best 0.58988), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=120.ckpt' as top 1
Epoch 0, global step 125: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 130: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 135: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 140: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 145: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 150: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 155: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 160: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 165: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 170: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 175: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 180: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 185: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 190: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 195: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 200: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 205: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 210: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 215: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 220: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 225: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 230: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 235: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 240: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 245: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 250: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 255: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 260: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 265: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 270: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 275: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 280: 'valid/cross_entropy_loss' reached 0.58627 (best 0.58627), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=280.ckpt' as top 1
Epoch 0, global step 285: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 290: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 295: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 300: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 305: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 310: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 315: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 320: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 325: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 330: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 335: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 340: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 345: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 350: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 355: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 360: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 365: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 370: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 375: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 380: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 385: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 390: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 395: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 400: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 405: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 410: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 415: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 420: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 425: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 430: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 435: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 440: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 445: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 450: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 455: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 460: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 465: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 470: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 475: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 480: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 485: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 490: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 495: 'valid/cross_entropy_loss' reached 0.58474 (best 0.58474), saving model to './fwal/2j4rnfq3/checkpoints/epoch=0-step=495.ckpt' as top 1
Epoch 0, global step 500: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 505: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 510: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 515: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 520: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 525: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 530: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 535: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 540: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 545: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 550: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 555: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 560: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 565: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 570: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 575: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 580: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 585: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 590: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 595: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 600: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 605: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 610: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 615: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 620: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 625: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 630: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 635: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 640: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 645: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 650: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 655: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 660: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 665: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 670: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 675: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 680: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 685: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 690: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 695: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 700: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 705: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 710: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 715: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 720: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 725: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 730: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 735: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 740: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 745: 'valid/cross_entropy_loss' was not in top 1
Epoch 0, global step 750: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 755: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 760: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 765: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 770: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 775: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 780: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 785: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 790: 'valid/cross_entropy_loss' reached 0.57750 (best 0.57750), saving model to './fwal/2j4rnfq3/checkpoints/epoch=1-step=790.ckpt' as top 1
Epoch 1, global step 795: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 800: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 805: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 810: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 815: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 820: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 825: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 830: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 835: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 840: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 845: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 850: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 855: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 860: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 865: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 870: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 875: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 880: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 885: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 890: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 895: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 900: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 905: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 910: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 915: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 920: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 925: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 930: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 935: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 940: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 945: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 950: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 955: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 960: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 965: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 970: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 975: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 980: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 985: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 990: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 995: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1000: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1005: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1010: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1015: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1020: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1025: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1030: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1035: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1040: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1045: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1050: 'valid/cross_entropy_loss' was not in top 1
Epoch 1, global step 1055: 'valid/cross_entropy_loss' was not in top 1
